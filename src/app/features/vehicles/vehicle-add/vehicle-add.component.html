<div class="az-content az-content-app az-content-contacts pd-b-0">
  <div class="container">
    <app-components-sidebar></app-components-sidebar>
    <div class="az-content-body pd-lg-l-40 d-flex flex-column">
      <div class="az-content-breadcrumb">
        <span>Vehicles</span>
        <span>List</span>
      </div>
      <div class="row justify-content-between mg-b-20">
        <div class="col-sm-8">
          <h2 *ngIf="!id; else update" class="az-content-title">Add New Car</h2>
          <ng-template #update><h2 class="az-content-title">Edit Car</h2></ng-template>
        </div>
        <div class="col-sm-4 d-flex align-items-center justify-content-end">
          <button mat-stroked-button color="primary" (click)="onVehicles()">
            Vehicles List
          </button>
        </div>
      </div>

      <mat-stepper #stepper>
        <mat-step [stepControl]="carForm" errorMessage="Name is required.">
          <form [formGroup]="carForm">
            <ng-template matStepLabel>Fill out car data</ng-template>
            <div class="form-row mb-3">
              <!--model-->
              <mat-form-field class="col full-width">
                <mat-label>Model</mat-label>
                <input type="text" matInput id="model" formControlName="model" placeholder="Enter model">
                <mat-error
                  *ngIf="(carForm.get('model').invalid && carForm.get('model').dirty) || carForm.get('model').hasError('required')">
                  Model is required
                </mat-error>
              </mat-form-field>
              <!-- Brand -->
              <mat-form-field class="col full-width">
                <mat-label>Brand</mat-label>
                <select matNativeControl id="brand" formControlName="brand">
                  <option value="">Select Brand</option>
                  <option value="Toyota">Toyota</option>
                  <option value="Honda">Honda</option>
                  <option value="Ford">Ford</option>
                </select>
                <mat-error
                  *ngIf="(carForm.get('brand').invalid && carForm.get('brand').dirty) || carForm.get('brand').hasError('required')">
                  Brand is required
                </mat-error>
              </mat-form-field>

            </div>
            <div class="form-row mb-3">
              <!-- Type -->
              <mat-form-field class="col full-width">
                <mat-label>Type</mat-label>
                <mat-select id="type" formControlName="type" >
                  <mat-option value="">Select type</mat-option>
                  <mat-option value="Luxury Cars">Luxury Cars</mat-option>
                  <mat-option value="Sports Cars">Sports Cars</mat-option>
                  <mat-option value="Convertibles">Convertibles</mat-option>
                  <mat-option value="Compact Cars">Compact Cars</mat-option>
                </mat-select>
                <mat-error *ngIf="carForm.get('type').invalid && carForm.get('type').dirty">
                  Type is required
                </mat-error>
              </mat-form-field>
              <!-- Registration -->
              <mat-form-field class="col full-width">
                <mat-label>Registration</mat-label>
                <input type="text" matInput id="registration" formControlName="registration"
                       placeholder="Enter registration number">
                <mat-error
                  *ngIf="(carForm.get('registration').invalid && carForm.get('registration').dirty) || carForm.get('registration').hasError('required')">
                  Registration is required
                </mat-error>
              </mat-form-field>

            </div>
            <div class="form-row mb-3">
              <!-- Date of Registration -->

              <mat-form-field class="col full-width">
                <mat-label>Date of Registration</mat-label>
                <input matInput required formControlName="dateOfRegistration"
                       [matDatepicker]="dateOfRegistrationPicker">
                <mat-datepicker-toggle matIconSuffix [for]="dateOfRegistrationPicker"></mat-datepicker-toggle>
                <mat-datepicker #dateOfRegistrationPicker></mat-datepicker>
                <mat-error
                  *ngIf="carForm.get('dateOfRegistration').invalid && carForm.get('dateOfRegistration').dirty && !carForm.get('dateOfRegistration').hasError('required')">
                  Please enter a valid Date of Registration
                </mat-error>
                <mat-error
                  *ngIf="(carForm.get('dateOfRegistration').invalid && carForm.get('dateOfRegistration').dirty) || carForm.get('dateOfRegistration').hasError('required')">
                  Date of Registration is required
                </mat-error>
              </mat-form-field>
              <!--status-->
              <mat-form-field class="col full-width">
                <mat-label>Status</mat-label>
                <mat-select id="status" formControlName="status" >
                  <mat-option value="">Select Status</mat-option>
                  <mat-option value="Available">Available</mat-option>
                  <mat-option value="Rent">Rent</mat-option>
                </mat-select>
                <mat-error
                  *ngIf="(carForm.get('status').invalid && carForm.get('status').dirty) || carForm.get('status').hasError('required')">
                  Status is required
                </mat-error>
              </mat-form-field>
            </div>
            <div class="form-row mb-3">
              <!-- Price -->
              <mat-form-field class="col full-width">
                <mat-label>Price per Day</mat-label>
                <input type="number" matInput id="pricePerDay" formControlName="pricePerDay"
                       placeholder="Enter price per Day">
                <mat-error
                  *ngIf="(carForm.get('pricePerDay').invalid && carForm.get('pricePerDay').dirty) || carForm.get('pricePerDay').hasError('required')">
                  Price is required and must be greater than or equal to 0
                </mat-error>
              </mat-form-field>
              <!-- Color -->
              <mat-form-field class="col full-width">
                <mat-label>Color</mat-label>
                <mat-select id="color" formControlName="status" >
                  <mat-option value="">Select Color</mat-option>
                  <mat-option value="red">Red</mat-option>
                  <mat-option value="black">Black</mat-option>
                  <mat-option value="white">White</mat-option>
                </mat-select>
                <mat-error
                  *ngIf="(carForm.get('color').invalid && carForm.get('color').dirty) || carForm.get('color').hasError('required')">
                  Color is required
                </mat-error>
              </mat-form-field>
            </div>
            <!-- Submit Button -->
            <div>
              <button mat-stroked-button color="primary" matStepperNext>Next</button>
            </div>
          </form>
        </mat-step>
        <mat-step errorMessage="Address is required.">
          <ng-template matStepLabel>Add images</ng-template>
          <!-- Right Side: Upload Images and Uploaded Images -->
          <!-- Upload Images -->
          <div class="card mb-4">
            <div class="card-header bg-marin text-white">
              <h5 class="card-title">Upload Images</h5>
            </div>
            <div class="card-body">
              <div class="form-group">
                <label for="images">Car Images:</label>
                <input type="file" class="form-control-file" id="images" multiple (change)="onSelectImages($event)">
                <small class="form-text text-muted">Please upload images of the car.</small>
              </div>

              <!-- Add More Images Button -->
              <button type="button" mat-stroked-button color="primary" [disabled]="!selectedImages.length"
                      (click)="onAddMoreImages()">
                Add More Images
              </button>
            </div>
          </div>

          <!-- Uploaded Images -->
          <div class="card mb-4">
            <div class="card-header bg-marin text-white">
              <h5 class="card-title">Uploaded Images</h5>
            </div>
            <div class="card-body">
              <div class="row">

                <div *ngFor="let imageUrl of imageUrls; let i = index" class="col-md-3 mb-3">
                  <div class="card">
                    <div class="card-img-container">
                      <img [src]="imageUrl" class="card-img-top" alt="Car Image">
                    </div>
                    <div class="card-body">
                      <button type="button" mat-stroked-button color="warn" (click)="onDeleteImage(i)">
                        Delete
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div>
            <button mat-stroked-button color="warn" matStepperPrevious>Back</button>
            <button mat-stroked-button color="primary" matStepperNext>Next</button>
          </div>
        </mat-step>
        <mat-step>
          <ng-template matStepLabel>Done</ng-template>
          <p>You are now done.</p>
          <div>
            <button mat-button  color="warn" matStepperPrevious>Back</button>
            <button mat-button  color="warn" (click)="stepper.reset()">Reset</button>
            <button mat-button  color="primary" (click)="onSubmit()">Save</button>
          </div>
        </mat-step>
      </mat-stepper>
    </div>
  </div>
</div>
